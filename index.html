<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>ç°ç° åœ£è¯å¿«ä¹</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      background: radial-gradient(circle at top, #24102f, #050515 70%, #000000);
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
      color: #ffeefe;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
    .greeting {
      position: fixed;
      top: 5%;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      pointer-events: none;
      text-shadow: 0 0 16px rgba(255, 150, 230, 1);
      z-index: 2;
    }
    .greeting-main {
      font-size: clamp(28px, 5vw, 42px);
      font-weight: 700;
      letter-spacing: 0.18em;
    }
    .greeting-sub {
      margin-top: 6px;
      font-size: clamp(16px, 3.2vw, 22px);
      opacity: 0.95;
    }
    .footer-note {
      position: fixed;
      bottom: 6px;
      right: 10px;
      font-size: 10px;
      opacity: 0.35;
      pointer-events: none;
      z-index: 2;
    }
  </style>
</head>
<body>
  <div class="greeting">
    <div class="greeting-main">ç°ç° åœ£è¯å¿«ä¹</div>
    <div class="greeting-sub">Merry Christmas âœ¨</div>
  </div>
  <div class="footer-note">for ç°ç°</div>

  <canvas id="treeCanvas"></canvas>

  <script>
    (function () {
      var canvas = document.getElementById("treeCanvas");
      var ctx = canvas.getContext("2d");

      var W, H, cx, baseY, treeH;
      var spiralPoints = []; // æ ‘æä¸Šçš„ç²’å­ï¼ˆå¤šæ¡èºæ—‹ï¼‰
      var groundRing = [];   // åœ°é¢å…‰ç¯ç²’å­
      var snow = [];
      var lastTime = performance.now();

      function resize() {
        W = window.innerWidth || document.documentElement.clientWidth;
        H = window.innerHeight || document.documentElement.clientHeight;

        var dpr = window.devicePixelRatio || 1;
        canvas.width = W * dpr;
        canvas.height = H * dpr;
        canvas.style.width = W + "px";
        canvas.style.height = H + "px";
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

        cx = W / 2;
        baseY = H * 0.8;
        treeH = H * 0.62;

        createSpiralTree();
        createGroundRing();
        createSnow();
      }

      window.addEventListener("resize", resize);
      resize();

      function rand(min, max) {
        return Math.random() * (max - min) + min;
      }

      // ğŸŒ² åˆ›å»ºâ€œæ ‘ææ„Ÿâ€çš„èºæ—‹ç²’å­æ ‘
      function createSpiralTree() {
        spiralPoints = [];
        var arms = 4;             // èºæ—‹ææ¡æ¡æ•°
        var turns = 9;            // æ¯æ¡èºæ—‹ç»•å¤šå°‘åœˆ
        var pointsPerArm = 1200;  // æ¯æ¡æä¸Šçš„ç²’å­æ•°

        for (var a = 0; a < arms; a++) {
          var armOffset = (a / arms) * Math.PI * 2;
          for (var i = 0; i < pointsPerArm; i++) {
            var u = i / (pointsPerArm - 1);   // 0â†’1 ä»åº•åˆ°é¡¶
            var level = u;

            // æ ‘èº«é«˜åº¦
            var baseHeight = baseY - (1 - level) * treeH;

            // è®©æ ‘æä¸€å±‚ä¸€å±‚èµ·ä¼ï¼ˆæ ‘ææ„Ÿï¼‰
            var branchWave = Math.sin(level * 16 * Math.PI) * 6 * (1 - level);
            var y = baseHeight + branchWave;

            // åŠå¾„ï¼šåº•éƒ¨æœ€å¤§ï¼Œé¡¶éƒ¨æ”¶å°–
            var widthFactor = (1 - level);
            widthFactor = Math.pow(widthFactor, 1.2);
            var radius = widthFactor * (W * 0.23);

            // èºæ—‹è§’åº¦
            var angle = turns * level * Math.PI * 2 + armOffset;

            // åŠ ä¸€ç‚¹éšæœºï¼Œé¿å…å¤ªè§„æ•´
            radius += rand(-4, 4);

            spiralPoints.push({
              level: level,
              baseRadius: radius,
              baseAngle: angle,
              baseY: y,
              size: rand(1.2, 2.4),
              phase: rand(0, Math.PI * 2),
              twinkleSpeed: rand(1.5, 3.5),
              swaySpeed: rand(1.0, 2.2),
              swayAmp: rand(0.5, 2.5)
            });
          }
        }
      }

      // åœ°é¢ç¯å½¢å…‰å¸¦
      function createGroundRing() {
        groundRing = [];
        var count = 260;
        var radius = W * 0.38;
        var y = baseY + 12;
        for (var i = 0; i < count; i++) {
          var angle = (i / count) * Math.PI * 2;
          groundRing.push({
            baseAngle: angle,
            radius: radius + rand(-10, 10),
            y: y + rand(-4, 4),
            size: rand(1.4, 2.2),
            phase: rand(0, Math.PI * 2),
            baseAlpha: rand(0.18, 0.35)
          });
        }
      }

      // é›ªèŠ±
      function createSnow() {
        snow = [];
        var count = Math.floor(650 * (W * H) / (800 * 600));
        for (var i = 0; i < count; i++) {
          snow.push({
            x: rand(0, W),
            y: rand(-H, H),
            vy: rand(30, 90),
            amp: rand(5, 20),
            phase: rand(0, Math.PI * 2),
            size: rand(0.8, 1.8)
          });
        }
      }

      function drawBackground() {
        ctx.fillStyle = "#050515";
        ctx.fillRect(0, 0, W, H);

        // åœ°é¢æŸ”å…‰
        var grd = ctx.createRadialGradient(
          cx, baseY + 25, 10,
          cx, baseY + 25, W * 0.8
        );
        grd.addColorStop(0, "rgba(255,210,250,0.42)");
        grd.addColorStop(0.35, "rgba(255,190,245,0.24)");
        grd.addColorStop(1, "rgba(0,0,0,0)");
        ctx.fillStyle = grd;
        ctx.beginPath();
        ctx.arc(cx, baseY + 25, W * 0.8, 0, Math.PI * 2);
        ctx.fill();
      }

      function drawTrunk() {
        var tw = Math.max(18, W * 0.02);
        var th = Math.max(50, H * 0.09);
        ctx.fillStyle = "#8a5538";
        ctx.fillRect(cx - tw / 2, baseY, tw, th);
      }

      function drawStar(t) {
        var topY = baseY - treeH;
        var baseR = Math.max(10, Math.min(W, H) * 0.02);
        var pulse = 1 + 0.2 * Math.sin(t * 3);
        var outer = baseR * pulse;
        var inner = outer * 0.5;

        var g = ctx.createRadialGradient(
          cx, topY, 0,
          cx, topY, outer * 4
        );
        g.addColorStop(0, "rgba(255,255,210,0.98)");
        g.addColorStop(1, "rgba(255,255,210,0)");
        ctx.fillStyle = g;
        ctx.beginPath();
        ctx.arc(cx, topY, outer * 4, 0, Math.PI * 2);
        ctx.fill();

        ctx.save();
        ctx.translate(cx, topY);
        ctx.rotate(t * 0.5);
        ctx.beginPath();
        var spikes = 5;
        for (var i = 0; i < spikes * 2; i++) {
          var r = (i % 2 === 0) ? outer : inner;
          var ang = (i * Math.PI) / spikes;
          var x = Math.cos(ang) * r;
          var y = Math.sin(ang) * r;
          if (i === 0) ctx.moveTo(x, y);
          else ctx.lineTo(x, y);
        }
        ctx.closePath();
        ctx.fillStyle = "rgba(255,255,235,1)";
        ctx.fill();
        ctx.restore();
      }

      function loop(now) {
        var dt = (now - lastTime) / 1000;
        if (dt > 0.05) dt = 0.05;
        lastTime = now;
        var t = now / 1000;

        drawBackground();
        drawTrunk();

        // â„ é›ª
        for (var i = 0; i < snow.length; i++) {
          var s = snow[i];
          s.y += s.vy * dt;
          s.x += Math.sin(t * 1.5 + s.phase) * s.amp * dt;

          if (s.y > H + 10) {
            s.y = rand(-50, -10);
            s.x = rand(0, W);
          }
          if (s.x < -20) s.x = W + 20;
          if (s.x > W + 20) s.x = -20;

          ctx.beginPath();
          ctx.fillStyle = "rgba(235,235,255,0.9)";
          ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
          ctx.fill();
        }

        // åœ°é¢å…‰ç¯æ—‹è½¬
        for (i = 0; i < groundRing.length; i++) {
          var gP = groundRing[i];
          var angle = gP.baseAngle + t * 0.2;
          var gx = cx + Math.cos(angle) * gP.radius;
          var gy = gP.y;
          var alphaG = gP.baseAlpha + 0.15 * Math.sin(t * 2 + gP.phase);
          if (alphaG < 0.05) alphaG = 0.05;
          if (alphaG > 0.6) alphaG = 0.6;

          ctx.beginPath();
          ctx.fillStyle = "rgba(255,200,250," + alphaG + ")";
          ctx.arc(gx, gy, gP.size, 0, Math.PI * 2);
          ctx.fill();
        }

        // æ ‘æèºæ—‹ç²’å­
        for (i = 0; i < spiralPoints.length; i++) {
          var p = spiralPoints[i];

          // æ•´æ£µæ ‘çš„æ—‹è½¬
          var angle = p.baseAngle + t * 0.4;

          // ç”¨ cos(angle) åšç®€å•çš„â€œå‰åæ™¯æ·±â€
          var depth = (Math.cos(angle) + 1) / 2; // 0~1ï¼Œ1 = ç¦»æˆ‘ä»¬æœ€è¿‘

          // åœ¨åŠå¾„ä¸Šå åŠ ä¸€ç‚¹å·¦å³æ‘†åŠ¨ï¼Œè®©ææ¡æ›´æ´»
          var sway = Math.sin(t * p.swaySpeed + p.phase) * p.swayAmp * (0.3 + 0.7 * depth);

          var radiusOnScreen = (p.baseRadius + sway) * (0.55 + 0.7 * depth);

          var x = cx + Math.sin(angle) * radiusOnScreen;
          var y = p.baseY + (1 - depth) * 12; // è¿œå¤„ç¨å¾®å¾€ä¸Š

          // é—ªçƒ
          var alpha = p.baseAlpha + 0.4 * Math.sin(t * p.twinkleSpeed + p.phase);
          alpha = alpha * (0.35 + 0.75 * depth);
          if (alpha < 0.05) alpha = 0.05;
          if (alpha > 1) alpha = 1;

          var size = p.size * (0.7 + 0.9 * depth);

          ctx.beginPath();
          // è¶Šé å‰è¶Šäº®ã€è¶Šç™½ï¼›é è¾¹ç¼˜åç²‰
          var gVal = Math.round(130 + depth * 90);
          var bVal = Math.round(220 + depth * 25);
          ctx.fillStyle = "rgba(255," + gVal + "," + bVal + "," + alpha + ")";
          ctx.arc(x, y, size, 0, Math.PI * 2);
          ctx.fill();
        }

        drawStar(t);
        requestAnimationFrame(loop);
      }

      requestAnimationFrame(loop);
    })();
  </script>
</body>
</html>
