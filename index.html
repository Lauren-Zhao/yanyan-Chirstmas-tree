<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>琰琰 圣诞快乐</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: radial-gradient(circle at top, #2b123a, #050515 65%, #000000);
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
      color: #ffeefe;
    }

    canvas {
      display: block;
    }

    .greeting {
      position: fixed;
      top: 5%;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      pointer-events: none;
      text-shadow: 0 0 10px rgba(255, 150, 230, 0.9);
    }

    .greeting-main {
      font-size: clamp(26px, 5vw, 40px);
      font-weight: 700;
      letter-spacing: 0.15em;
    }

    .greeting-sub {
      margin-top: 6px;
      font-size: clamp(16px, 3.2vw, 22px);
      opacity: 0.9;
    }

    .footer-note {
      position: fixed;
      bottom: 6px;
      right: 10px;
      font-size: 10px;
      opacity: 0.35;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div class="greeting">
    <div class="greeting-main">琰琰 圣诞快乐</div>
    <div class="greeting-sub">Merry Christmas ✨</div>
  </div>
  <div class="footer-note">for 琰琰</div>
  <canvas id="treeCanvas"></canvas>

  <script>
    const canvas = document.getElementById("treeCanvas");
    const ctx = canvas.getContext("2d");

    let W, H, centerX, baseY, treeHeight;
    let particles = [];
    let snows = [];

    function resize() {
      W = window.innerWidth;
      H = window.innerHeight;
      canvas.width = W;
      canvas.height = H;
      centerX = W / 2;
      baseY = H * 0.8;
      treeHeight = H * 0.6;
      createTreeParticles();
      createSnows();
    }

    window.addEventListener("resize", resize);
    resize();

    function rand(min, max) {
      return Math.random() * (max - min) + min;
    }

    class Particle {
      constructor(x, y, color) {
        this.baseX = x;
        this.baseY = y;
        this.color = color;
        this.amp = rand(0.5, 2.5);
        this.speed = rand(1.0, 3.0);
        this.phase = rand(0, Math.PI * 2);
        this.size = rand(1.3, 2.3);
      }

      draw(t) {
        const offset = Math.sin(t * this.speed + this.phase) * this.amp;
        const x = this.baseX + offset;
        const y = this.baseY;
        ctx.beginPath();
        ctx.fillStyle = this.color;
        ctx.arc(x, y, this.size, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    class Snow {
      constructor() {
        this.reset(true);
      }

      reset(startRandomY = false) {
        this.x = rand(0, W);
        this.y = startRandomY ? rand(-H, 0) : rand(-50, -10);
        this.speedY = rand(30, 80);
        this.speedX = rand(-10, 10);
        this.size = rand(1, 3);
        this.swingPhase = rand(0, Math.PI * 2);
        this.swingAmp = rand(5, 15);
      }

      update(dt, t) {
        this.y += this.speedY * dt;
        this.x += Math.sin(t * 1.2 + this.swingPhase) * dt * this.swingAmp;
        if (this.y > H + 10) {
          this.reset(false);
        }
      }

      draw() {
        ctx.beginPath();
        ctx.fillStyle = "rgba(235,235,255,0.9)";
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function createTreeParticles() {
      particles = [];
      const count = Math.floor(1800 * (W * H) / (800 * 600)); // 尺寸自适应粒子数量
      for (let i = 0; i < count; i++) {
        const r = Math.random();
        const y = baseY - r * treeHeight;
        const level = (baseY - y) / treeHeight;
        const halfWidth = 20 + level * (W * 0.19);
        let x = centerX + rand(-halfWidth, halfWidth);

        const angle = level * 10 * Math.PI;
        const spiralOffset = Math.sin(angle) * 15 * (1 - level);
        x += spiralOffset;

        const baseCol = [255, 150, 230]; // 粉色基调
        const jitter = (v) => Math.max(0, Math.min(255, v + rand(-20, 20)));
        const color = `rgb(${jitter(baseCol[0])},${jitter(baseCol[1])},${jitter(baseCol[2])})`;

        particles.push(new Particle(x, y, color));
      }
    }

    function createSnows() {
      snows = [];
      const count = Math.floor(180 * (W * H) / (800 * 600));
      for (let i = 0; i < count; i++) {
        snows.push(new Snow());
      }
    }

    function drawGlow(t) {
      const topY = baseY - treeHeight;
      const maxR = Math.min(W, H) * 0.35;
      const layers = 7;
      for (let i = 0; i < layers; i++) {
        const radius = maxR * (i + 1) / layers;
        const alpha = 0.14 - i * 0.015;
        if (alpha <= 0) continue;
        const pulse = 1 + 0.06 * Math.sin(t * 1.5 + i);
        ctx.beginPath();
        ctx.fillStyle = `rgba(255,160,240,${alpha})`;
        ctx.arc(centerX, topY, radius * pulse, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function drawTrunk() {
      const trunkWidth = Math.max(18, W * 0.02);
      const trunkHeight = Math.max(50, H * 0.09);
      ctx.fillStyle = "#8a5538";
      ctx.fillRect(centerX - trunkWidth / 2, baseY, trunkWidth, trunkHeight);
    }

    function drawStar(t) {
      const topY = baseY - treeHeight;
      const baseR = Math.max(8, Math.min(W, H) * 0.01);
      const pulse = 1 + 0.15 * Math.sin(t * 3);
      const radius = baseR * pulse;

      // 外部光晕
      const gradient = ctx.createRadialGradient(
        centerX, topY, radius * 0.2,
        centerX, topY, radius * 3
      );
      gradient.addColorStop(0, "rgba(255,255,210,0.9)");
      gradient.addColorStop(1, "rgba(255,255,210,0)");
      ctx.fillStyle = gradient;
      ctx.beginPath();
      ctx.arc(centerX, topY, radius * 3, 0, Math.PI * 2);
      ctx.fill();

      // 星形
      const spikes = 5;
      const outerRadius = radius * 1.6;
      const innerRadius = radius * 0.6;
      ctx.save();
      ctx.translate(centerX, topY);
      ctx.rotate(t * 0.6);
      ctx.beginPath();
      for (let i = 0; i < spikes * 2; i++) {
        const r = i % 2 === 0 ? outerRadius : innerRadius;
        const angle = (i * Math.PI) / spikes;
        const x = Math.cos(angle) * r;
        const y = Math.sin(angle) * r;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      }
      ctx.closePath();
      ctx.fillStyle = "rgba(255,255,220,0.98)";
      ctx.fill();
      ctx.restore();
    }

    let lastTime = performance.now();

    function loop(now) {
      const dt = (now - lastTime) / 1000;
      lastTime = now;
      const t = now / 1000;

      // 背景渐变叠加一点轻微动感
      ctx.clearRect(0, 0, W, H);
      ctx.fillStyle = "#050515";
      ctx.fillRect(0, 0, W, H);

      drawGlow(t);
      drawTrunk();

      // 雪
      for (const s of snows) {
        s.update(dt, t);
        s.draw();
      }

      // 树粒子
      for (const p of particles) {
        p.draw(t);
      }

      // 星星
      drawStar(t);

      requestAnimationFrame(loop);
    }

    requestAnimationFrame(loop);
  </script>
</body>
</html>
