<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>琰琰 圣诞快乐</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      background: radial-gradient(circle at top, #2b123a, #050515 65%, #000000);
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
      color: #ffeefe;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
    .greeting {
      position: fixed;
      top: 5%;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      pointer-events: none;
      text-shadow: 0 0 12px rgba(255, 150, 230, 0.95);
      z-index: 2;
    }
    .greeting-main {
      font-size: clamp(26px, 5vw, 40px);
      font-weight: 700;
      letter-spacing: 0.15em;
    }
    .greeting-sub {
      margin-top: 6px;
      font-size: clamp(16px, 3.2vw, 22px);
      opacity: 0.9;
    }
    .footer-note {
      position: fixed;
      bottom: 6px;
      right: 10px;
      font-size: 10px;
      opacity: 0.35;
      pointer-events: none;
      z-index: 2;
    }
  </style>
</head>
<body>
  <div class="greeting">
    <div class="greeting-main">琰琰 圣诞快乐</div>
    <div class="greeting-sub">Merry Christmas ✨</div>
  </div>
  <div class="footer-note">for 琰琰</div>

  <canvas id="treeCanvas"></canvas>

  <script>
    (function () {
      var canvas = document.getElementById("treeCanvas");
      var ctx = canvas.getContext("2d");

      var W, H, cx, baseY, treeH;
      var treeParticles = [];
      var snowParticles = [];
      var lastTime = performance.now();

      function resize() {
        W = window.innerWidth;
        H = window.innerHeight;
        var dpr = window.devicePixelRatio || 1;
        canvas.width = W * dpr;
        canvas.height = H * dpr;
        canvas.style.width = W + "px";
        canvas.style.height = H + "px";
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

        cx = W / 2;
        baseY = H * 0.8;
        treeH = H * 0.6;

        createTreeParticles();
        createSnowParticles();
      }

      window.addEventListener("resize", resize);
      resize();

      function rand(min, max) {
        return Math.random() * (max - min) + min;
      }

      // 创建粉色粒子圣诞树
      function createTreeParticles() {
        treeParticles = [];
        var count = Math.floor(2200 * (W * H) / (800 * 600)); // 粒子数量，分辨率越大越多
        var i;
        for (i = 0; i < count; i++) {
          var level = Math.random();                // 0 底部，1 顶部
          var y = baseY - level * treeH;
          var halfWidth = 20 + level * (W * 0.25);  // 越往下越宽
          var x = cx + (Math.random() * 2 - 1) * halfWidth;

          // 轻微螺旋，让树有一点 3D 感
          var angle = level * 10 * Math.PI;
          var spiralOffset = Math.sin(angle) * 22 * (1 - level);
          x += spiralOffset;

          // 粉色灯光
          var baseR = 255;
          var baseG = 160;
          var baseB = 240;
          var jR = Math.round(baseR + rand(-15, 15));
          var jG = Math.round(baseG + rand(-30, 30));
          var jB = Math.round(baseB + rand(-15, 15));
          jR = Math.max(160, Math.min(255, jR));
          jG = Math.max(60, Math.min(230, jG));
          jB = Math.max(160, Math.min(255, jB));

          treeParticles.push({
            x: x,
            y: y,
            r: jR,
            g: jG,
            b: jB,
            size: rand(1.4, 2.4),
            swayAmp: rand(0.5, 2.5),
            swaySpeed: rand(1.0, 3.0),
            twinkleSpeed: rand(1.5, 3.5),
            phase: rand(0, Math.PI * 2),
            baseAlpha: rand(0.4, 0.8)
          });
        }
      }

      // 创建大量雪花
      function createSnowParticles() {
        snowParticles = [];
        var count = Math.floor(450 * (W * H) / (800 * 600)); // 雪花数量加倍
        var i;
        for (i = 0; i < count; i++) {
          snowParticles.push({
            x: rand(0, W),
            y: rand(-H, H),
            vy: rand(25, 80),
            vx: rand(-10, 10),
            size: rand(1, 3),
            phase: rand(0, Math.PI * 2),
            amp: rand(5, 18)
          });
        }
      }

      function drawBackground() {
        // 夜空
        ctx.fillStyle = "#050515";
        ctx.fillRect(0, 0, W, H);

        // 地面光环
        var grd = ctx.createRadialGradient(
          cx, baseY + 20, 10,
          cx, baseY + 20, W * 0.7
        );
        grd.addColorStop(0, "rgba(255,210,250,0.4)");
        grd.addColorStop(0.3, "rgba(255,190,245,0.25)");
        grd.addColorStop(1, "rgba(0,0,0,0)");
        ctx.fillStyle = grd;
        ctx.beginPath();
        ctx.arc(cx, baseY + 20, W * 0.7, 0, Math.PI * 2);
        ctx.fill();

        // 远处星点
        ctx.fillStyle = "rgba(255,255,255,0.4)";
        var s;
        for (s = 0; s < 60; s++) {
          var sx = Math.random() * W;
          var sy = Math.random() * H * 0.6;
          ctx.fillRect(sx, sy, 1, 1);
        }
      }

      function drawTrunk() {
        var tw = Math.max(18, W * 0.02);
        var th = Math.max(50, H * 0.09);
        ctx.fillStyle = "#8a5538";
        ctx.fillRect(cx - tw / 2, baseY, tw, th);
      }

      function drawStar(t) {
        var topY = baseY - treeH;
        var baseR = Math.max(10, Math.min(W, H) * 0.02);
        var pulse = 1 + 0.18 * Math.sin(t * 3);
        var outerR = baseR * pulse;
        var innerR = outerR * 0.5;

        // 光晕
        var g = ctx.createRadialGradient(
          cx, topY, 0,
          cx, topY, outerR * 4
        );
        g.addColorStop(0, "rgba(255,255,210,0.95)");
        g.addColorStop(1, "rgba(255,255,210,0)");
        ctx.fillStyle = g;
        ctx.beginPath();
        ctx.arc(cx, topY, outerR * 4, 0, Math.PI * 2);
        ctx.fill();

        // 星形
        ctx.save();
        ctx.translate(cx, topY);
        ctx.rotate(t * 0.6);
        ctx.beginPath();
        var spikes = 5;
        var i;
        for (i = 0; i < spikes * 2; i++) {
          var r = (i % 2 === 0) ? outerR : innerR;
          var ang = (i * Math.PI) / spikes;
          var x = Math.cos(ang) * r;
          var y = Math.sin(ang) * r;
          if (i === 0) {
            ctx.moveTo(x, y);
          } else {
            ctx.lineTo(x, y);
          }
        }
        ctx.closePath();
        ctx.fillStyle = "rgba(255,255,230,1)";
        ctx.fill();
        ctx.restore();
      }

      function loop(now) {
        var dt = (now - lastTime) / 1000;
        if (dt > 0.05) { dt = 0.05; }
        lastTime = now;
        var t = now / 1000;

        drawBackground();
        drawTrunk();

        // 雪花更新 & 绘制（很多）
        var i, s, p;
        for (i = 0; i < snowParticles.length; i++) {
          s = snowParticles[i];
          s.y += s.vy * dt;
          s.x += Math.sin(t * 1.2 + s.phase) * dt * s.amp;

          if (s.y > H + 10) {
            s.y = rand(-50, -10);
            s.x = rand(0, W);
          }
          if (s.x < -20) { s.x = W + 20; }
          if (s.x > W + 20) { s.x = -20; }

          ctx.beginPath();
          ctx.fillStyle = "rgba(235,235,255,0.9)";
          ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
          ctx.fill();
        }

        // 树粒子
        for (i = 0; i < treeParticles.length; i++) {
          p = treeParticles[i];
          var sway = Math.sin(t * p.swaySpeed + p.phase) * p.swayAmp;
          var alpha = p.baseAlpha + 0.4 * Math.sin(t * p.twinkleSpeed + p.phase);
          if (alpha < 0.1) { alpha = 0.1; }
          if (alpha > 1) { alpha = 1; }

          ctx.beginPath();
          ctx.fillStyle = "rgba(" + p.r + "," + p.g + "," + p.b + "," + alpha + ")";
          ctx.arc(p.x + sway, p.y, p.size, 0, Math.PI * 2);
          ctx.fill();
        }

        drawStar(t);
        requestAnimationFrame(loop);
      }

      requestAnimationFrame(loop);
    })();
  </script>
</body>
</html>
