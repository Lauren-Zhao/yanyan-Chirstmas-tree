<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>琰琰 圣诞快乐</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      background: radial-gradient(circle at top, #2b123a, #050515 65%, #000000);
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
      color: #ffeefe;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
    .greeting {
      position: fixed;
      top: 5%;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      pointer-events: none;
      text-shadow: 0 0 12px rgba(255, 150, 230, 0.95);
      z-index: 2;
    }
    .greeting-main {
      font-size: clamp(26px, 5vw, 40px);
      font-weight: 700;
      letter-spacing: 0.15em;
    }
    .greeting-sub {
      margin-top: 6px;
      font-size: clamp(16px, 3.2vw, 22px);
      opacity: 0.9;
    }
    .footer-note {
      position: fixed;
      bottom: 6px;
      right: 10px;
      font-size: 10px;
      opacity: 0.35;
      pointer-events: none;
      z-index: 2;
    }
  </style>
</head>
<body>
  <div class="greeting">
    <div class="greeting-main">琰琰 圣诞快乐</div>
    <div class="greeting-sub">Merry Christmas ✨</div>
  </div>
  <div class="footer-note">for 琰琰</div>

  <canvas id="treeCanvas"></canvas>

  <script>
    (function () {
      var canvas = document.getElementById("treeCanvas");
      var ctx = canvas.getContext("2d");

      var W, H, cx, baseY, treeH;
      var treeParticles = [];
      var snowParticles = [];
      var lastTime = performance.now();

      function resize() {
        W = window.innerWidth || document.documentElement.clientWidth;
        H = window.innerHeight || document.documentElement.clientHeight;

        var dpr = window.devicePixelRatio || 1;
        canvas.width = W * dpr;
        canvas.height = H * dpr;
        canvas.style.width = W + "px";
        canvas.style.height = H + "px";
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

        cx = W / 2;
        baseY = H * 0.8;
        treeH = H * 0.6;

        createTreeParticles();
        createSnowParticles();
      }

      window.addEventListener("resize", resize);
      resize();

      function rand(min, max) {
        return Math.random() * (max - min) + min;
      }

      // 生成粉色粒子圣诞树
      function createTreeParticles() {
        treeParticles = [];
        var count = Math.floor(3200 * (W * H) / (800 * 600)); // 粒子很多
        var i;
        for (i = 0; i < count; i++) {
          var level = Math.random();              // 0 底部, 1 顶部
          var y = baseY - level * treeH;
          var radius = 30 + level * (W * 0.25);   // 控制树的宽度
          var angle = Math.random() * Math.PI * 8;
          var x = cx + Math.sin(angle) * radius * (1 - level * 0.4);

          // 微微左右随机，避免太规整
          x += (Math.random() * 2 - 1) * 8;

          // 粉色系
          var r = 255;
          var g = 140 + Math.random() * 60;
          var b = 220 + Math.random() * 35;

          treeParticles.push({
            baseX: x,
            baseY: y,
            r: r,
            g: g,
            b: b,
            size: rand(1.2, 2.3),
            swayAmp: rand(0.5, 2.0),
            swaySpeed: rand(1.0, 3.0),
            twinkleSpeed: rand(1.5, 3.5),
            phase: rand(0, Math.PI * 2),
            baseAlpha: rand(0.4, 0.8)
          });
        }
      }

      // 生成大量雪花
      function createSnowParticles() {
        snowParticles = [];
        var count = Math.floor(600 * (W * H) / (800 * 600)); // 雪比之前多
        var i;
        for (i = 0; i < count; i++) {
          snowParticles.push({
            x: rand(0, W),
            y: rand(-H, H),
            vy: rand(30, 90),
            amp: rand(5, 20),
            phase: rand(0, Math.PI * 2),
            size: rand(1, 3)
          });
        }
      }

      function drawBackground() {
        ctx.fillStyle = "#050515";
        ctx.fillRect(0, 0, W, H);

        // 地面光圈
        var grd = ctx.createRadialGradient(
          cx, baseY + 20, 10,
          cx, baseY + 20, W * 0.7
        );
        grd.addColorStop(0, "rgba(255,210,250,0.45)");
        grd.addColorStop(0.3, "rgba(255,190,245,0.28)");
        grd.addColorStop(1, "rgba(0,0,0,0)");
        ctx.fillStyle = grd;
        ctx.beginPath();
        ctx.arc(cx, baseY + 20, W * 0.7, 0, Math.PI * 2);
        ctx.fill();
      }

      function drawTrunk() {
        var tw = Math.max(18, W * 0.02);
        var th = Math.max(50, H * 0.09);
        ctx.fillStyle = "#8a5538";
        ctx.fillRect(cx - tw / 2, baseY, tw, th);
      }

      function drawStar(t) {
        var topY = baseY - treeH;
        var baseR = Math.max(10, Math.min(W, H) * 0.02);
        var pulse = 1 + 0.2 * Math.sin(t * 3);
        var outer = baseR * pulse;
        var inner = outer * 0.5;

        // 光晕
        var g = ctx.createRadialGradient(
          cx, topY, 0,
          cx, topY, outer * 4
        );
        g.addColorStop(0, "rgba(255,255,210,0.98)");
        g.addColorStop(1, "rgba(255,255,210,0)");
        ctx.fillStyle = g;
        ctx.beginPath();
        ctx.arc(cx, topY, outer * 4, 0, Math.PI * 2);
        ctx.fill();

        // 星形本体
        ctx.save();
        ctx.translate(cx, topY);
        ctx.rotate(t * 0.5);
        ctx.beginPath();
        var spikes = 5;
        var i;
        for (i = 0; i < spikes * 2; i++) {
          var r = (i % 2 === 0) ? outer : inner;
          var ang = (i * Math.PI) / spikes;
          var x = Math.cos(ang) * r;
          var y = Math.sin(ang) * r;
          if (i === 0) ctx.moveTo(x, y);
          else ctx.lineTo(x, y);
        }
        ctx.closePath();
        ctx.fillStyle = "rgba(255,255,235,1)";
        ctx.fill();
        ctx.restore();
      }

      function loop(now) {
        var dt = (now - lastTime) / 1000;
        if (dt > 0.05) dt = 0.05;
        lastTime = now;
        var t = now / 1000;

        drawBackground();
        drawTrunk();

        // 雪花
        var i, s, p;
        for (i = 0; i < snowParticles.length; i++) {
          s = snowParticles[i];
          s.y += s.vy * dt;
          s.x += Math.sin(t * 1.5 + s.phase) * s.amp * dt;

          if (s.y > H + 10) {
            s.y = rand(-50, -10);
            s.x = rand(0, W);
          }
          if (s.x < -20) s.x = W + 20;
          if (s.x > W + 20) s.x = -20;

          ctx.beginPath();
          ctx.fillStyle = "rgba(235,235,255,0.9)";
          ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
          ctx.fill();
        }

        // 树粒子
        for (i = 0; i < treeParticles.length; i++) {
          p = treeParticles[i];
          var sway = Math.sin(t * p.swaySpeed + p.phase) * p.swayAmp;
          var alpha = p.baseAlpha + 0.4 * Math.sin(t * p.twinkleSpeed + p.phase);
          if (alpha < 0.1) alpha = 0.1;
          if (alpha > 1) alpha = 1;

          ctx.beginPath();
          ctx.fillStyle = "rgba(" + p.r + "," + p.g + "," + p.b + "," + alpha + ")";
          ctx.arc(p.baseX + sway, p.baseY, p.size, 0, Math.PI * 2);
          ctx.fill();
        }

        drawStar(t);
        requestAnimationFrame(loop);
      }

      requestAnimationFrame(loop);
    })();
  </script>
</body>
</html>
